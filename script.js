const _0x3ef64e=_0x1f97;!function(e,$){let x=_0x1f97,t=e();for(;;)try{let a=-parseInt(x(452))/1+-parseInt(x(500))/2+-parseInt(x(524))/3+-parseInt(x(496))/4*(parseInt(x(489))/5)+parseInt(x(528))/6+-parseInt(x(543))/7*(-parseInt(x(447))/8)+parseInt(x(442))/9;if(438413===a)break;t.push(t.shift())}catch(r){t.push(t.shift())}}(_0x261a,438413);const API_KEY=_0x3ef64e(529),SPREADSHEET_ID="1cD50d0-oSTogEe9tYo9ABUSP1ONCy3SAV92zsYYIG84",RANGO=_0x3ef64e(501);let allData=[],searchTimer=null,isLoading=!1;const searchInput=document[_0x3ef64e(531)](_0x3ef64e(485)),resultsContainer=document[_0x3ef64e(531)](_0x3ef64e(440)),statusMessage=document[_0x3ef64e(531)](_0x3ef64e(518));function handleConnectionChange(){let e=_0x3ef64e;navigator.onLine?(document[e(458)][e(523)][e(451)]("offline"),0===allData[e(538)]&&loadData()):document[e(458)][e(523)][e(540)](e(510))}async function loadData(){let e=_0x3ef64e;if(!isLoading){isLoading=!0,showStatus(e(509),e(544));try{let $=await fetch(e(499)+"1cD50d0-oSTogEe9tYo9ABUSP1ONCy3SAV92zsYYIG84"+e(461)+RANGO+e(478)+API_KEY);if(!$.ok)throw Error(e(439));let x=await $.json();allData=x.values||[],cacheProductImages(),searchInput[e(473)][e(484)]()?performSearch(searchInput[e(473)].trim()):showStatus(e(526),e(448))}catch(t){console.error(e(486),t),showStatus(e(517),"empty")}finally{isLoading=!1}}}async function cacheProductImages(){let e=_0x3ef64e;if(!navigator[e(450)]||!navigator[e(450)][e(469)]){console[e(536)](e(545));return}let $=[];if(allData[e(527)](x=>{let t=e;if(x[1]){let a=x[1][t(530)](",");a.forEach(e=>{let x=t,a=e.trim();a&&!$[x(497)](a)&&$[x(535)](a)})}}),0===$[e(538)])return;let x=new MessageChannel;return new Promise((t,a)=>{let r=e;x[r(515)][r(479)]=e=>{let $=r;e.data[$(532)]?(console[$(536)]($(493)),t()):(console[$(465)]($(542),e[$(471)][$(465)]),a(e[$(471)][$(465)]))},navigator[r(450)].controller[r(482)]({type:r(505),imageUrls:$},[x[r(477)]])})}function _0x1f97(e,$){e-=437;let x=_0x261a();return x[e]}async function updateImageCache(){let e=_0x3ef64e;if(!confirm(e(520)))return;if(!navigator[e(450)]||!navigator[e(450)][e(469)]){alert(e(545));return}let $=statusMessage[e(445)];showStatus(e(444),e(544));try{let x=new MessageChannel;await new Promise(($,t)=>{let a=e;x[a(515)][a(479)]=e=>{let x=a;e[x(471)][x(532)]?$():t(e[x(471)].error)},navigator[a(450)].controller.postMessage({type:a(516)},[x.port2])}),await cacheProductImages(),alert("✅ Im\xe1genes actualizadas correctamente"),searchInput.value.trim()?performSearch(searchInput[e(473)][e(484)]()):showStatus(e(526),e(448))}catch(t){console[e(465)](e(483),t),alert(e(464)),showStatus($,"empty")}}function handleSearchInput(){let e=_0x3ef64e;clearTimeout(searchTimer);let $=searchInput.value[e(484)]();if(0===$[e(538)]){clearResults(),showStatus(e(526),e(448));return}showStatus("Buscando...","searching"),searchTimer=setTimeout(()=>{performSearch($)},300)}function performSearch(e){let $=_0x3ef64e;if(0===allData.length){loadData();return}let x=e.toLowerCase(),t=allData[$(504)](e=>{let t=$;return e[2]&&e[2][t(455)]().toLowerCase()[t(497)](x)||e[3]&&e[3][t(455)]()[t(508)]()[t(497)](x)||e[6]&&e[6][t(455)]()[t(508)]()[t(497)](x)||e[7]&&e[7][t(455)]()[t(508)]()[t(497)](x)});displayResults(t)}function displayResults(e){let $=_0x3ef64e;if(clearResults(),0===e.length){showStatus($(533),$(448));return}hideStatus(),e[$(527)](e=>{let x=createResultCard(e);resultsContainer[$(490)](x)})}function createResultCard(e){let $=_0x3ef64e,x=document[$(438)]($(474));x[$(480)]=$(539);let t=document[$(438)]($(474));if(t[$(480)]=$(441),e[1]){let a=e[1][$(530)](","),r=a[0][$(484)]();if(r){let s=document[$(438)]($(514));s[$(495)]=r,s[$(449)]=e[3]||$(498),s[$(476)]=()=>{let e=$;t[e(523)][e(540)](e(454)),t[e(541)]=e(522)},t[$(490)](s)}else t[$(523)].add($(454)),t[$(541)]="Sin imagen"}else t[$(523)].add($(454)),t[$(541)]=$(522);let _=document[$(438)]($(474));_[$(480)]=$(459);let n=e[2]||e[6]||"S/C",c=document[$(438)]($(474));c.className=$(456),c.textContent="C\xf3digo: "+n;let i=e[3]||"Sin nombre",l=document[$(438)]("div");l.className=$(492),l.textContent=i;let o=e[5]||$(491),f=document.createElement("div");return f[$(480)]="result-price",f[$(541)]=o,_[$(490)](c),_[$(490)](l),_[$(490)](f),x.appendChild(t),x[$(490)](_),x}function showStatus(e,$){let x=_0x3ef64e;$===x(544)||e[x(497)](x(537))||e[x(497)](x(467))?statusMessage[x(445)]=e:statusMessage[x(445)]=e+x(466),statusMessage[x(480)]=$,statusMessage[x(534)][x(460)]=x(453)}function hideStatus(){let e=_0x3ef64e;statusMessage.style[e(460)]=e(503)}function clearResults(){let e=_0x3ef64e,$=resultsContainer.querySelectorAll(e(462));$[e(527)]($=>$[e(451)]())}function newSearch(){searchInput.value="",clearResults(),showStatus(_0x3ef64e(526),"empty")}function _0x261a(){let e=["1631544nLKvcL","./service-worker.js","Ingrese c\xf3digo o nombre del producto","forEach","2586306oRPLUz","AIzaSyDwiZWDc66tv4usDIA-IreiJMLFuk0236Q","split","getElementById","success","\uD83D\uDE15 No se encontraron resultados","style","push","log","spinner","length","result-card","add","textContent","Error al cachear im\xe1genes:","77OQxTBB","searching","Service Worker no disponible","focus","createElement","Error al cargar datos","resultsContainer","result-image","12931425iVwQCv","slice",'Actualizando im\xe1genes... <div class="spinner"></div>',"innerHTML","innerHeight","445984VYkMLR","empty","alt","serviceWorker","remove","220060FVlYKM","block","no-image","toString","result-code","hidden","body","result-info","display","/values/",".result-card","visibilitychange","❌ Error al actualizar las im\xe1genes","error",'<br><img id="statusLogo" src="logo.png" alt="Distribuidora HomePoint" onclick="updateImageCache()">',"Buscando","key","controller","click","data",".key","value","div","catch","onerror","port2","?key=","onmessage","className","documentElement","postMessage","Error al actualizar im\xe1genes:","trim","searchInput","Error:","Backspace","Service Worker error:","5210fTICuU","appendChild","Consultar","result-name","Im\xe1genes cacheadas exitosamente","preventDefault","src","2308zsjVTs","includes","Producto","https://sheets.googleapis.com/v4/spreadsheets/","1355098WhiymZ","PriceDisplay!A2:I","online","none","filter","CACHE_IMAGES","reload","target","toLowerCase",'<div class="spinner"></div>',"offline","setProperty","register","resize","img","port1","CLEAR_IMAGE_CACHE","❌ Error al cargar los datos. Verifique su conexi\xf3n.","statusMessage","addEventListener","\xbfDesea actualizar todas las im\xe1genes de productos? Esto puede tardar un momento.","blur","Sin imagen","classList"];return(_0x261a=function(){return e})()}searchInput.addEventListener(_0x3ef64e(437),e=>{let $=_0x3ef64e;e[$(507)][$(521)](),e[$(494)]()}),window.addEventListener(_0x3ef64e(502),handleConnectionChange),window[_0x3ef64e(519)](_0x3ef64e(510),handleConnectionChange),window.addEventListener("DOMContentLoaded",()=>{let e=_0x3ef64e;0===allData[e(538)]&&loadData()}),document.querySelectorAll(_0x3ef64e(472))[_0x3ef64e(527)](e=>{let $=_0x3ef64e;e[$(519)]($(470),e=>{let x=$,t=e[x(507)].dataset[x(468)];t&&(t===x(487)?searchInput[x(473)]=searchInput[x(473)][x(443)](0,-1):searchInput[x(473)]+=t,handleSearchInput())})}),_0x3ef64e(450) in navigator&&navigator.serviceWorker[_0x3ef64e(512)](_0x3ef64e(525))[_0x3ef64e(475)](e=>console[_0x3ef64e(465)](_0x3ef64e(488),e));let inactivityTimer=null;function resetInactivityTimer(){clearTimeout(inactivityTimer),inactivityTimer=setTimeout(()=>{location[_0x1f97(506)]()},12e4)}function fixViewportHeight(){let e=_0x3ef64e;document[e(481)][e(534)][e(511)]("--vh",.01*window[e(446)]+"px")}[_0x3ef64e(470),"touchstart"][_0x3ef64e(527)](e=>{let $=_0x3ef64e;document[$(519)](e,resetInactivityTimer,!0)}),resetInactivityTimer(),window[_0x3ef64e(519)](_0x3ef64e(513),fixViewportHeight),document[_0x3ef64e(519)](_0x3ef64e(463),()=>{let e=_0x3ef64e;document[e(457)]||fixViewportHeight()}),fixViewportHeight();